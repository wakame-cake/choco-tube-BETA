<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>„ÉÅ„Éß„Ç≥chat</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      min-height: 100vh;
    }

    body.theme-default {
      background-color: #fff;
      color: #000;
    }

    body.theme-dark {
      background-color: #222;
      color: #ddd;
    }

    body.theme-light {
      background-color: #f9f9f9;
      color: #333;
    }

    body.theme-blue {
      background-color: #e0f7fa;
      color: #006064;
    }

    .hidden {
      display: none !important;
    }

    .back-to-youtube {
      background: linear-gradient(135deg, #8b4513 0%, #a0522d 100%);
      padding: 12px 20px;
      text-align: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }

    .back-to-youtube a {
      color: white;
      text-decoration: none;
      font-size: 16px;
      font-weight: bold;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 20px;
      background: rgba(255,255,255,0.15);
      border-radius: 20px;
      transition: background 0.3s, transform 0.2s;
    }

    .back-to-youtube a:hover {
      background: rgba(255,255,255,0.25);
      transform: scale(1.05);
    }

    .theme-dark .back-to-youtube {
      background: linear-gradient(135deg, #5d3a1a 0%, #7a4a2a 100%);
    }

    #auth-section {
      min-height: calc(100vh - 60px);
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .auth-container {
      background: white;
      padding: 40px;
      border-radius: 16px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
      width: 100%;
      max-width: 400px;
      animation: fadeIn 0.5s ease;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .auth-container h1 {
      text-align: center;
      color: #333;
      margin-bottom: 30px;
      font-size: 28px;
    }

    .auth-form {
      display: none;
    }

    .auth-form.active {
      display: block;
      animation: fadeIn 0.3s ease;
    }

    .auth-form h3 {
      color: #333;
      margin-bottom: 10px;
    }

    .auth-hint {
      color: #666;
      font-size: 14px;
      margin-bottom: 20px;
    }

    .auth-form input {
      width: 100%;
      padding: 15px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 16px;
      margin-bottom: 15px;
      transition: border-color 0.3s, box-shadow 0.3s;
    }

    .auth-form input:focus {
      outline: none;
      border-color: #3498db;
      box-shadow: 0 0 5px rgba(52, 152, 219, 0.5);
    }

    .auth-form button {
      width: 100%;
      padding: 15px;
      background-color: #3498db;
      border: none;
      border-radius: 8px;
      color: white;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s, transform 0.2s;
    }

    .auth-form button:hover {
      background-color: #2980b9;
      transform: scale(1.05);
    }

    .auth-toggle {
      text-align: center;
      margin-top: 20px;
      color: #666;
      font-size: 14px;
    }

    .auth-toggle a {
      color: #3498db;
      cursor: pointer;
      text-decoration: underline;
    }

    .auth-toggle a:hover {
      color: #2980b9;
    }

    .error-message {
      color: #e74c3c;
      font-size: 14px;
      padding: 10px;
      background: #fdeaea;
      border-radius: 8px;
      margin-top: 15px;
      animation: shake 0.5s ease;
    }

    .success-message {
      color: #27ae60;
      font-size: 14px;
      padding: 10px;
      background: #e8f8f0;
      border-radius: 8px;
      margin-top: 15px;
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }

    #chat-section {
      margin-top: 0px;
      padding: 20px;
    }

    .chat-header {
      text-align: center;
      margin-bottom: 10px;
    }

    .chat-header h2 {
      font-size: 24px;
      color: #333;
    }

    .theme-dark .chat-header h2 {
      color: #ddd;
    }

    .chat-header h3 {
      font-size: 14px;
      color: #666;
      margin-top: 5px;
    }

    .theme-dark .chat-header h3 {
      color: #aaa;
    }

    #chat-box {
      border: 1px solid #ccc;
      height: 600px;
      overflow-y: scroll;
      padding: 10px;
      margin-bottom: 10px;
      background: #f9f9f9;
    }

    .theme-dark #chat-box {
      background: #333;
      border-color: #555;
    }

    .message-container {
      border: 1px solid #ccc;
      background-color: #f5f5f5;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 4px;
      box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
      position: relative;
    }

    .message-container.own-message {
      border-left: 4px solid #2ecc71;
    }

    .theme-dark .message-container {
      background-color: #444;
      border-color: #666;
    }

    .theme-dark .message-container.own-message {
      border-left: 4px solid #27ae60;
    }

    .message-name {
      font-weight: bold;
      margin-bottom: 5px;
    }

    .status-text {
      font-size: 14px;
      color: #555;
      opacity: 1;
      margin-left: 8px;
      font-weight: normal;
    }

    .message-text {
      white-space: pre-wrap;
      margin-bottom: 5px;
      font-size: 16px;
      line-height: 1.5;
      word-break: break-word;
      overflow-wrap: break-word;
    }

    .reply-quote {
      color: #888;
      font-style: italic;
      margin: 2px 0;
      padding: 5px;
      background: rgba(0,0,0,0.05);
      border-left: 3px solid #ccc;
      border-radius: 3px;
      font-size: 13px;
    }

    .theme-dark .reply-quote {
      background: rgba(255,255,255,0.1);
      border-left-color: #666;
    }

    .message-time {
      font-size: 0.8em;
      color: gray;
      text-align: right;
    }

    .theme-dark .message-time {
      color: #aaa;
    }

    .message-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .edited-mark {
      font-size: 12px;
      color: #888;
      font-style: italic;
    }

    .input-area {
      margin-bottom: 10px;
    }

    .input-hint {
      font-size: 12px;
      color: #888;
      margin: 5px;
    }

    .input-area textarea {
      margin: 5px;
      padding: 14px;
      width: calc(100% - 22px);
      height: 140px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 18px;
      resize: vertical;
      font-family: inherit;
      line-height: 1.5;
    }

    .theme-dark .input-area textarea {
      background: #333;
      border-color: #555;
      color: #ddd;
    }

    .input-area textarea:focus {
      outline: none;
      border: 1px solid #3498db;
      box-shadow: 0 0 5px rgba(52,152,219,0.5);
      transition: box-shadow 0.3s ease, border 0.3s ease;
    }

    .input-area button {
      background-color: #3498db;
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease;
      font-weight: bold;
    }

    .input-area button:hover {
      background-color: #2980b9;
      transform: scale(1.05);
    }

    .button-row {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 15px;
    }

    .button-row button,
    .button-row a {
      background-color: #3498db;
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease;
      text-decoration: none;
      font-size: 14px;
    }

    .button-row button:hover,
    .button-row a:hover {
      background-color: #2980b9;
      transform: scale(1.05);
    }

    #logoutButton {
      background-color: #e74c3c;
    }

    #logoutButton:hover {
      background-color: #c0392b;
    }

    #command-summary {
      background: #f0f0f0;
      border: 1px solid #ccc;
      border-radius: 16px;
      padding: 25px;
      margin: 20px 0;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .theme-dark #command-summary {
      background: #333;
      border-color: #555;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    #command-summary h3 {
      margin-top: 0;
      color: #333;
      margin-bottom: 20px;
      font-size: 18px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .theme-dark #command-summary h3 {
      color: #ddd;
    }

    #command-summary h3::before {
      content: "‚ö°";
      font-size: 22px;
    }

    .command-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 12px;
    }

    .command-item {
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 12px;
      padding: 15px;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .theme-dark .command-item {
      background: #444;
      border-color: #555;
    }

    .command-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    .command-name {
      font-family: 'Courier New', monospace;
      font-weight: bold;
      font-size: 15px;
      color: #3498db;
      margin-bottom: 6px;
    }

    .theme-dark .command-name {
      color: #5dade2;
    }

    .command-desc {
      font-size: 13px;
      color: #666;
      line-height: 1.4;
    }

    .theme-dark .command-desc {
      color: #aaa;
    }

    .command-example {
      margin-top: 6px;
      font-size: 11px;
      color: #999;
      font-style: italic;
    }

    .theme-dark .command-example {
      color: #777;
    }

    .command-item.admin-only {
      border-color: #e74c3c;
      background: #fff5f5;
    }

    .theme-dark .command-item.admin-only {
      background: #4a3333;
      border-color: #c0392b;
    }

    .admin-badge {
      font-size: 10px;
      background: #e74c3c;
      color: white;
      padding: 2px 6px;
      border-radius: 4px;
      margin-left: 6px;
    }

    #profile-settings {
      margin: 20px 0;
      padding: 15px;
      border: 1px solid #ccc;
      border-radius: 8px;
      background-color: #f0f0f0;
    }

    .theme-dark #profile-settings {
      background-color: #333;
      border-color: #555;
    }

    #profile-settings h3 {
      margin-top: 0;
      margin-bottom: 15px;
      color: #333;
    }

    .theme-dark #profile-settings h3 {
      color: #ddd;
    }

    .profile-row {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
      margin-bottom: 10px;
    }

    #profile-settings input,
    #profile-settings select {
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 14px;
    }

    .theme-dark #profile-settings input,
    .theme-dark #profile-settings select {
      background-color: #444;
      border-color: #666;
      color: #ddd;
    }

    #profile-settings input[type="text"] {
      width: 150px;
    }

    #profile-settings input[type="color"] {
      width: 50px;
      height: 35px;
      padding: 2px;
      cursor: pointer;
    }

    #profile-settings button {
      background-color: #2ecc71;
      border: none;
      padding: 8px 16px;
      color: #fff;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    #profile-settings button:hover {
      background-color: #27ae60;
    }

    .action-menu-btn {
      position: absolute;
      top: 5px;
      right: 5px;
      background-color: #f0f0f0;
      border: 1px solid #ccc;
      color: #333;
      border-radius: 4px;
      cursor: pointer;
      font-size: 18px;
      padding: 5px 8px;
      opacity: 0;
      transition: opacity 0.2s;
    }

    .theme-dark .action-menu-btn {
      background-color: #555;
      border-color: #666;
      color: #ddd;
    }

    .message-container:hover .action-menu-btn {
      opacity: 1;
    }

    .action-menu {
      position: absolute;
      right: 5px;
      top: 30px;
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      z-index: 100;
    }

    .theme-dark .action-menu {
      background: #444;
      border-color: #666;
    }

    .action-menu div {
      padding: 8px 12px;
      cursor: pointer;
      white-space: nowrap;
      font-size: 14px;
    }

    .action-menu div:hover {
      background-color: #eee;
    }

    .theme-dark .action-menu div:hover {
      background-color: #555;
    }

    .action-menu div.delete {
      color: #e74c3c;
    }

    .system-message {
      text-align: center;
      color: #888;
      font-size: 13px;
      padding: 10px;
      font-style: italic;
    }

    .message-text a {
      color: #3498db;
      text-decoration: underline;
      word-break: break-all;
    }

    .message-text a:hover {
      color: #2980b9;
    }

    .theme-dark .message-text a {
      color: #5dade2;
    }

    .theme-dark .message-text a:hover {
      color: #85c1e9;
    }

    #reply-preview {
      background: #f0f0f0;
      padding: 10px 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border: 1px solid #ccc;
      border-radius: 4px;
      margin-bottom: 10px;
    }

    .theme-dark #reply-preview {
      background: #444;
      border-color: #666;
    }

    #reply-to-text {
      font-size: 13px;
      color: #666;
    }

    .theme-dark #reply-to-text {
      color: #aaa;
    }

    #cancel-reply {
      background: none;
      border: none;
      font-size: 18px;
      cursor: pointer;
      color: #999;
      padding: 5px;
    }

    #cancel-reply:hover {
      color: #e74c3c;
    }

    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .modal-content {
      background: white;
      padding: 30px;
      border-radius: 16px;
      width: 90%;
      max-width: 500px;
    }

    .theme-dark .modal-content {
      background: #333;
      color: #ddd;
    }

    .modal-content h3 {
      margin-bottom: 20px;
      color: #333;
    }

    .theme-dark .modal-content h3 {
      color: #ddd;
    }

    .modal-content textarea {
      width: 100%;
      padding: 15px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      resize: vertical;
      min-height: 100px;
      margin-bottom: 20px;
      font-family: inherit;
    }

    .theme-dark .modal-content textarea {
      background: #444;
      border-color: #666;
      color: #ddd;
    }

    .modal-buttons {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
    }

    .modal-buttons button {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s;
    }

    #save-edit-btn {
      background: #3498db;
      color: white;
    }

    #save-edit-btn:hover {
      background: #2980b9;
    }

    #cancel-edit-btn {
      background: #e0e0e0;
      color: #333;
    }

    #cancel-edit-btn:hover {
      background: #d0d0d0;
    }

    #typing-indicator {
      font-size: 14px;
      font-style: italic;
      color: #888;
      margin-bottom: 10px;
    }

    .online-info {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
      padding: 10px;
      background: #f5f5f5;
      border-radius: 4px;
    }

    .theme-dark .online-info {
      background: #333;
    }

    .online-info span {
      font-size: 14px;
      color: #666;
    }

    .theme-dark .online-info span {
      color: #aaa;
    }

    #user-count {
      background: #3498db;
      color: white;
      padding: 3px 10px;
      border-radius: 12px;
      font-size: 12px;
    }

    .user-info-display {
      background: #e8f4fd;
      border: 1px solid #3498db;
      padding: 10px 15px;
      border-radius: 8px;
      margin-bottom: 15px;
      font-size: 14px;
    }

    .theme-dark .user-info-display {
      background: #2a4a5a;
      border-color: #5dade2;
    }

    .user-info-display .display-name {
      font-weight: bold;
      color: #2980b9;
    }

    .theme-dark .user-info-display .display-name {
      color: #85c1e9;
    }

    @media (max-width: 600px) {
      #chat-section {
        padding: 10px;
      }

      #chat-box {
        height: 400px;
      }

      .input-area textarea {
        width: calc(100% - 12px);
        height: 110px;
        font-size: 16px;
      }

      .button-row {
        flex-direction: column;
      }

      .button-row button,
      .button-row a {
        width: 100%;
        text-align: center;
      }

      .profile-row {
        flex-direction: column;
        align-items: stretch;
      }

      #profile-settings input[type="text"] {
        width: 100%;
      }
    }
  </style>
</head>
<body class="theme-default">
  <div class="back-to-youtube">
    <a href="/">üç´ „ÉÅ„Éß„Ç≥Tube„Å´Êàª„Çã</a>
  </div>

  <div id="auth-section">
    <div class="auth-container">
      <h1>„ÉÅ„Éß„Ç≥chat</h1>

      <div id="login-form" class="auth-form active">
        <h3>„É≠„Ç∞„Ç§„É≥</h3>
        <p class="auth-hint">„Ç¢„Ç´„Ç¶„É≥„ÉàÊÉÖÂ†±„ÇíÂÖ•Âäõ„Åó„Å¶„ÉÅ„É£„ÉÉ„Éà„Å´ÂèÇÂä†</p>
        <input type="text" id="loginDisplayName" placeholder="ÂêçÂâç (‰æã: „É¶„Éº„Ç∂„ÉºÂêç)" maxlength="50">
        <input type="password" id="loginPassword" placeholder="„Éë„Çπ„ÉØ„Éº„Éâ">
        <button id="loginButton">„É≠„Ç∞„Ç§„É≥</button>
        <div class="auth-toggle">
          „Ç¢„Ç´„Ç¶„É≥„Éà„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÅãÔºü <a id="showSignup">Êñ∞Ë¶èÁôªÈå≤</a>
        </div>
      </div>

      <div id="signup-form" class="auth-form">
        <h3>Êñ∞Ë¶èÁôªÈå≤</h3>
        <p class="auth-hint">Êñ∞„Åó„ÅÑ„Ç¢„Ç´„Ç¶„É≥„Éà„Çí‰ΩúÊàê</p>
        <input type="text" id="signupUsername" placeholder="„É¶„Éº„Ç∂„ÉºÂêç (1„Äú20ÊñáÂ≠ó)" maxlength="20">
        <input type="password" id="signupPassword" placeholder="„Éë„Çπ„ÉØ„Éº„Éâ (4ÊñáÂ≠ó‰ª•‰∏ä)">
        <input type="password" id="signupPasswordConfirm" placeholder="„Éë„Çπ„ÉØ„Éº„Éâ (Á¢∫Ë™ç)">
        <button id="signupButton">„Ç¢„Ç´„Ç¶„É≥„Éà‰ΩúÊàê</button>
        <div class="auth-toggle">
          Êó¢„Å´„Ç¢„Ç´„Ç¶„É≥„Éà„Åå„ÅÇ„Çä„Åæ„Åô„ÅãÔºü <a id="showLogin">„É≠„Ç∞„Ç§„É≥</a>
        </div>
      </div>

      <div id="auth-error" class="error-message hidden"></div>
      <div id="auth-success" class="success-message hidden"></div>
    </div>
  </div>

  <div id="chat-section" class="hidden">
    <div class="chat-header">
      <h2>choco-chat</h2>
      <h3>„Éô„Éº„ÇøÁâà„Åß„Åô„ÄÇÊîπÂñÑÁÇπ„ÅÇ„Å£„Åü„ÇâÊïô„Åà„Å¶</h3>
    </div>

    <div class="user-info-display">
      „É≠„Ç∞„Ç§„É≥‰∏≠: <span class="display-name" id="current-display-name"></span>
      <span id="admin-indicator" class="hidden" style="background: #e74c3c; color: white; padding: 2px 8px; border-radius: 4px; margin-left: 8px; font-size: 12px;">ÁÆ°ÁêÜËÄÖ</span>
    </div>

    <div class="online-info">
      <span>„Ç™„É≥„É©„Ç§„É≥:</span>
      <span id="user-count">0‰∫∫</span>
      <span id="user-names"></span>
    </div>

    <div id="typing-indicator" class="hidden"></div>

    <div id="chat-box"></div>

    <div id="reply-preview" class="hidden">
      <span id="reply-to-text"></span>
      <button id="cancel-reply">‚úï</button>
    </div>

    <div class="input-area">
      <textarea id="message-input" placeholder="„É°„ÉÉ„Çª„Éº„Ç∏„ÇíÂÖ•Âäõ..."></textarea>
      <div class="input-hint">Enter„ÅßÈÄÅ‰ø° / Shift+Enter „Åæ„Åü„ÅØ Space+Enter„ÅßÊîπË°å</div>
      <button id="send-btn">ÈÄÅ‰ø°</button>
    </div>
    <div class="button-row">
      <button id="logoutButton">„É≠„Ç∞„Ç¢„Ç¶„Éà</button>
    </div>

    <div id="command-summary">
      <h3>„Ç≥„Éû„É≥„Éâ</h3>
      <div class="command-grid">
        <div class="command-item">
          <div class="command-name">/prm</div>
          <div class="command-desc">„Éó„É©„Ç§„Éô„Éº„Éà„É°„ÉÉ„Çª„Éº„Ç∏„ÇíÈÄÅ„Çã</div>
          <div class="command-example">‰æã: /prm „É¶„Éº„Ç∂„ÉºÂêç ÂÜÖÂÆπ</div>
        </div>
        <div class="command-item admin-only">
          <div class="command-name">/delete<span class="admin-badge">ÁÆ°ÁêÜËÄÖÂ∞ÇÁî®</span></div>
          <div class="command-desc">ÂÖ®„É°„ÉÉ„Çª„Éº„Ç∏„ÇíÂâäÈô§</div>
        </div>
        <div class="command-item admin-only">
          <div class="command-name">/mute<span class="admin-badge">ÁÆ°ÁêÜËÄÖÂ∞ÇÁî®</span></div>
          <div class="command-desc">„É¶„Éº„Ç∂„Éº„Çí‰∏ÄÊôÇÁöÑ„Å´„Éü„É•„Éº„Éà</div>
          <div class="command-example">‰æã: /mute „É¶„Éº„Ç∂„ÉºÂêç 60</div>
        </div>
        <div class="command-item admin-only">
          <div class="command-name">/unmute<span class="admin-badge">ÁÆ°ÁêÜËÄÖÂ∞ÇÁî®</span></div>
          <div class="command-desc">„Éü„É•„Éº„Éà„ÇíËß£Èô§„Åó„Åæ„Åô</div>
          <div class="command-example">‰æã: /unmute „É¶„Éº„Ç∂„ÉºÂêç</div>
        </div>
        <div class="command-item admin-only">
          <div class="command-name">/ban<span class="admin-badge">ÁÆ°ÁêÜËÄÖÂ∞ÇÁî®</span></div>
          <div class="command-desc">„É¶„Éº„Ç∂„Éº„Çí„ÉÅ„É£„ÉÉ„Éà„Åã„ÇâËøΩ„ÅÑÂá∫„Åô</div>
          <div class="command-example">‰æã: /ban „É¶„Éº„Ç∂„ÉºÂêç</div>
        </div>
        <div class="command-item admin-only">
          <div class="command-name">/unban<span class="admin-badge">ÁÆ°ÁêÜËÄÖÂ∞ÇÁî®</span></div>
          <div class="command-desc">BAN„ÇíËß£Èô§„Åó„Åæ„Åô</div>
          <div class="command-example">‰æã: /unban „É¶„Éº„Ç∂„ÉºÂêç</div>
        </div>
      </div>
    </div>

    <div id="profile-settings">
      <h3>Ë®≠ÂÆö</h3>
      <div class="profile-row">
        <label>ÂêçÂâç„ÅÆËâ≤:</label>
        <input type="color" id="nameColor" value="#000000" title="ÂêçÂâç„ÅÆËâ≤">
      </div>
      <div class="profile-row">
        <label>„Çπ„ÉÜ„Éº„Çø„Çπ:</label>
        <input type="text" id="statusText" placeholder="„Çπ„ÉÜ„Éº„Çø„ÇπÊñáÁ´† (ÊúÄÂ§ß30ÊñáÂ≠ó)" maxlength="30" style="width: 200px;">
      </div>
      <div class="profile-row">
        <label>„ÉÜ„Éº„Éû:</label>
        <select id="themeSelect">
          <option value="default">„Éá„Éï„Ç©„É´„Éà</option>
          <option value="dark">„ÉÄ„Éº„ÇØ</option>
          <option value="light">„É©„Ç§„Éà</option>
          <option value="blue">„Éñ„É´„Éº</option>
        </select>
      </div>
      <div class="profile-row">
        <button id="updateProfileButton">Êõ¥Êñ∞</button>
      </div>
    </div>
  </div>

  <div id="edit-modal" class="modal hidden">
    <div class="modal-content">
      <h3>„É°„ÉÉ„Çª„Éº„Ç∏„ÇíÁ∑®ÈõÜ</h3>
      <textarea id="edit-message-input"></textarea>
      <div class="modal-buttons">
        <button id="save-edit-btn">‰øùÂ≠ò</button>
        <button id="cancel-edit-btn">„Ç≠„É£„É≥„Çª„É´</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script>
    window.CHAT_SERVER_URL = '{{ chat_server_url | default("") }}';
    
    function getServerUrl() {
      const urlParams = new URLSearchParams(window.location.search);
      const serverParam = urlParams.get('server');
      if (serverParam) return serverParam;
      if (window.CHAT_SERVER_URL && window.CHAT_SERVER_URL.length > 0) return window.CHAT_SERVER_URL;
      const loc = window.location;
      if (loc.hostname === 'localhost' || loc.hostname === '127.0.0.1') {
        return loc.protocol + '//' + loc.hostname + ':3001';
      }
      return window.location.origin;
    }

    const socket = io(getServerUrl(), {
      transports: ['websocket', 'polling'],
      reconnection: true,
      reconnectionAttempts: 10,
      reconnectionDelay: 1000,
      reconnectionDelayMax: 5000,
      timeout: 20000
    });

    const authSection = document.getElementById('auth-section');
    const chatSection = document.getElementById('chat-section');
    let currentUser = null;
    let currentProfile = null;
    let isAdmin = false;
    let replyToMessage = null;
    let editingMessageId = null;
    let openMenuId = null;
    let userStatusMap = {};
    let spacePressed = false;

    const savedToken = localStorage.getItem('chatToken');
    if (savedToken) {
      socket.emit('tokenLogin', { token: savedToken }, (response) => {
        if (response && response.success) {
          handleLoginSuccess(response);
        } else {
          localStorage.removeItem('chatToken');
          localStorage.removeItem('chatDisplayName');
        }
      });
    }

    const loginForm = document.getElementById('login-form');
    const signupForm = document.getElementById('signup-form');
    const authError = document.getElementById('auth-error');
    const authSuccess = document.getElementById('auth-success');
    const chatBox = document.getElementById('chat-box');
    const messageInput = document.getElementById('message-input');
    const sendBtn = document.getElementById('send-btn');
    const userCount = document.getElementById('user-count');
    const userNames = document.getElementById('user-names');
    const typingIndicator = document.getElementById('typing-indicator');
    const replyPreview = document.getElementById('reply-preview');
    const replyToText = document.getElementById('reply-to-text');
    const cancelReplyBtn = document.getElementById('cancel-reply');
    const editModal = document.getElementById('edit-modal');
    const editMessageInput = document.getElementById('edit-message-input');
    const themeSelect = document.getElementById('themeSelect');

    let typingTimeout;
    let heartbeatInterval;

    document.getElementById('showSignup').addEventListener('click', () => {
      loginForm.classList.remove('active');
      signupForm.classList.add('active');
      hideMessages();
    });

    document.getElementById('showLogin').addEventListener('click', () => {
      signupForm.classList.remove('active');
      loginForm.classList.add('active');
      hideMessages();
    });

    function hideMessages() {
      authError.classList.add('hidden');
      authSuccess.classList.add('hidden');
    }

    function showAuthError(message, dbError = null) {
      authSuccess.classList.add('hidden');
      if (dbError) {
        authError.innerHTML = `
          <div style="font-weight: bold; margin-bottom: 10px;">${message}</div>
          <div style="margin-bottom: 8px;"><strong>ÂéüÂõ†:</strong> ${dbError.cause || '‰∏çÊòé'}</div>
          <div style="background: #fff3cd; color: #856404; padding: 10px; border-radius: 6px; margin-top: 10px;">
            <strong>Ëß£Ê±∫ÊñπÊ≥ï:</strong><br>${dbError.solution || 'ÁÆ°ÁêÜËÄÖ„Å´ÈÄ£Áµ°„Åó„Å¶„Åè„Å†„Åï„ÅÑ'}
          </div>
        `;
      } else {
        authError.textContent = message;
      }
      authError.style.background = '#fdeaea';
      authError.style.color = '#e74c3c';
      authError.classList.remove('hidden');
    }

    function showAuthSuccess(message) {
      authError.classList.add('hidden');
      authSuccess.textContent = message;
      authSuccess.classList.remove('hidden');
    }

    function handleLoginSuccess(response) {
      currentUser = response.account.displayName;
      currentProfile = response.account;
      isAdmin = response.account.isAdmin || false;
      
      localStorage.setItem('chatToken', response.account.token);
      localStorage.setItem('chatDisplayName', response.account.displayName);

      authSection.classList.add('hidden');
      chatSection.classList.remove('hidden');

      document.getElementById('current-display-name').textContent = currentUser;
      if (isAdmin) {
        document.getElementById('admin-indicator').classList.remove('hidden');
      } else {
        document.getElementById('admin-indicator').classList.add('hidden');
      }

      applyTheme(response.account.theme || 'default');
      document.getElementById('nameColor').value = response.account.color || '#000000';
      document.getElementById('statusText').value = response.account.statusText || '';
      themeSelect.value = response.account.theme || 'default';

      chatBox.innerHTML = '';
      if (response.history && response.history.length > 0) {
        response.history.forEach(msg => addMessage(msg));
      }

      if (response.userStatuses) {
        userStatusMap = response.userStatuses;
      }

      updateUserList(response.onlineUsers || []);
      startHeartbeat();
      messageInput.focus();
    }

    document.getElementById('signupButton').addEventListener('click', () => {
      const username = document.getElementById('signupUsername').value.trim();
      const password = document.getElementById('signupPassword').value;
      const passwordConfirm = document.getElementById('signupPasswordConfirm').value;

      if (!username) {
        showAuthError('„É¶„Éº„Ç∂„ÉºÂêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
        return;
      }

      if (username.length < 1 || username.length > 20) {
        showAuthError('„É¶„Éº„Ç∂„ÉºÂêç„ÅØ1„Äú20ÊñáÂ≠ó„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
        return;
      }

      if (!password || password.length < 4) {
        showAuthError('„Éë„Çπ„ÉØ„Éº„Éâ„ÅØ4ÊñáÂ≠ó‰ª•‰∏ä„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
        return;
      }

      if (password !== passwordConfirm) {
        showAuthError('„Éë„Çπ„ÉØ„Éº„Éâ„Åå‰∏ÄËá¥„Åó„Åæ„Åõ„Çì');
        return;
      }

      socket.emit('signup', { username, password }, (response) => {
        if (response && response.success) {
          showAuthSuccess(`„Ç¢„Ç´„Ç¶„É≥„Éà„Çí‰ΩúÊàê„Åó„Åæ„Åó„ÅüÔºÅË°®Á§∫Âêç: ${response.account.displayName}`);
          document.getElementById('loginDisplayName').value = username;
          document.getElementById('signupUsername').value = '';
          document.getElementById('signupPassword').value = '';
          document.getElementById('signupPasswordConfirm').value = '';
          setTimeout(() => {
            signupForm.classList.remove('active');
            loginForm.classList.add('active');
          }, 2000);
        } else {
          showAuthError(response ? response.error : '„Ç¢„Ç´„Ç¶„É≥„Éà‰ΩúÊàê„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
        }
      });
    });

    document.getElementById('loginButton').addEventListener('click', () => {
      const username = document.getElementById('loginDisplayName').value.trim();
      const password = document.getElementById('loginPassword').value;

      if (!username) {
        showAuthError('ÂêçÂâç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
        return;
      }

      if (!password) {
        showAuthError('„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
        return;
      }

      socket.emit('accountLogin', { username, password }, (response) => {
        if (response && response.success) {
          handleLoginSuccess(response);
        } else {
          showAuthError(response ? response.error : '„É≠„Ç∞„Ç§„É≥„Å´Â§±Êïó„Åó„Åæ„Åó„Åü', response ? response.dbError : null);
        }
      });
    });

    document.getElementById('loginDisplayName').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        document.getElementById('loginButton').click();
      }
    });

    document.getElementById('loginPassword').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        document.getElementById('loginButton').click();
      }
    });

    document.getElementById('signupUsername').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        document.getElementById('signupButton').click();
      }
    });

    document.getElementById('signupPasswordConfirm').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        document.getElementById('signupButton').click();
      }
    });

    function applyTheme(theme) {
      document.body.className = `theme-${theme}`;
    }

    function startHeartbeat() {
      if (heartbeatInterval) clearInterval(heartbeatInterval);
      heartbeatInterval = setInterval(() => {
        if (socket.connected) {
          socket.emit('heartbeat');
        }
      }, 25000);
    }

    function stopHeartbeat() {
      if (heartbeatInterval) {
        clearInterval(heartbeatInterval);
        heartbeatInterval = null;
      }
    }

    function sendMessage() {
      const message = messageInput.value.trim();
      if (!message) return;

      socket.emit('sendMessage', {
        message,
        replyTo: replyToMessage
      }, (response) => {
        if (response.success) {
          messageInput.value = '';
          cancelReply();
          socket.emit('stopTyping');
        }
      });
    }

    sendBtn.addEventListener('click', sendMessage);

    messageInput.addEventListener('keydown', (e) => {
      if (e.key === ' ') {
        spacePressed = true;
      }
      
      if (e.key === 'Enter') {
        if (e.shiftKey || spacePressed) {
          return;
        }
        e.preventDefault();
        sendMessage();
      }
    });

    messageInput.addEventListener('keyup', (e) => {
      if (e.key === ' ') {
        spacePressed = false;
      }
    });

    messageInput.addEventListener('input', () => {
      socket.emit('typing');
      clearTimeout(typingTimeout);
      typingTimeout = setTimeout(() => {
        socket.emit('stopTyping');
      }, 1000);
    });

    function formatTime(timestamp) {
      const date = new Date(timestamp);
      return date.toLocaleTimeString('ja-JP', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    function linkifyUrls(text) {
      const urlPattern = /(https?:\/\/[^\s<>"{}|\\^`\[\]]+)/g;
      return text.replace(urlPattern, '<a href="$1" target="_blank" rel="noopener noreferrer">$1</a>');
    }

    function addMessage(data) {
      const isOwn = data.username === currentUser || data.username === currentUser + ' ÁÆ°ÁêÜËÄÖ';
      const isCommandResult = data.isCommandResult || false;
      const container = document.createElement('div');
      container.className = 'message-container' + (isOwn ? ' own-message' : '');
      container.dataset.id = data.id;

      let replyHtml = '';
      if (data.replyTo) {
        replyHtml = `<div class="reply-quote">‚Ü© ${escapeHtml(data.replyTo.username)}: ${escapeHtml(data.replyTo.message.substring(0, 30))}${data.replyTo.message.length > 30 ? '...' : ''}</div>`;
      }

      const editedMark = data.edited ? '<span class="edited-mark">(Á∑®ÈõÜÊ∏à„Åø)</span>' : '';
      const escapedMessage = escapeHtml(data.message);
      const linkedMessage = linkifyUrls(escapedMessage);
      const messageTextHtml = linkedMessage.replace(/\n/g, '<br>');

      let statusHtml = '';
      const baseUsername = data.username.replace(' ÁÆ°ÁêÜËÄÖ', '');
      if (data.statusText) {
        statusHtml = `<span class="status-text">${escapeHtml(data.statusText)}</span>`;
      } else if (userStatusMap[baseUsername]) {
        statusHtml = `<span class="status-text">${escapeHtml(userStatusMap[baseUsername])}</span>`;
      }

      container.innerHTML = `
        ${replyHtml}
        <div class="message-name" style="color: ${data.color || '#333'}">${escapeHtml(data.username)}${statusHtml}</div>
        <div class="message-text">${messageTextHtml}</div>
        <div class="message-meta">
          <span class="message-time">${formatTime(data.timestamp)}</span>
          ${editedMark}
        </div>
        ${!isCommandResult ? '<button class="action-menu-btn">‚ãÆ</button>' : ''}
      `;

      if (!isCommandResult) {
        const menuBtn = container.querySelector('.action-menu-btn');
        menuBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          toggleActionMenu(data, container, isOwn);
        });
      }

      chatBox.appendChild(container);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    function toggleActionMenu(data, container, isOwn) {
      const existingMenu = document.querySelector('.action-menu');
      if (existingMenu) {
        existingMenu.remove();
        if (openMenuId === data.id) {
          openMenuId = null;
          return;
        }
      }

      openMenuId = data.id;
      const menu = document.createElement('div');
      menu.className = 'action-menu';

      let menuHtml = `<div class="reply-action">Ëøî‰ø°</div>`;
      if (isOwn) {
        menuHtml += `<div class="edit-action">Á∑®ÈõÜ</div>`;
        menuHtml += `<div class="delete-action delete">ÂâäÈô§</div>`;
      }
      menu.innerHTML = menuHtml;

      menu.querySelector('.reply-action').addEventListener('click', () => {
        setReplyTo(data);
        menu.remove();
        openMenuId = null;
      });

      if (isOwn) {
        menu.querySelector('.edit-action').addEventListener('click', () => {
          openEditModal(data);
          menu.remove();
          openMenuId = null;
        });

        menu.querySelector('.delete-action').addEventListener('click', () => {
          if (confirm('„Åì„ÅÆ„É°„ÉÉ„Çª„Éº„Ç∏„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü')) {
            socket.emit('deleteMessage', { id: data.id }, (response) => {
              if (!response.success) {
                alert(response.error);
              }
            });
          }
          menu.remove();
          openMenuId = null;
        });
      }

      container.appendChild(menu);
    }

    document.addEventListener('click', () => {
      const existingMenu = document.querySelector('.action-menu');
      if (existingMenu) {
        existingMenu.remove();
        openMenuId = null;
      }
    });

    function setReplyTo(data) {
      replyToMessage = {
        id: data.id,
        username: data.username,
        message: data.message
      };
      replyToText.textContent = `${data.username}„Å´Ëøî‰ø°: ${data.message.substring(0, 30)}${data.message.length > 30 ? '...' : ''}`;
      replyPreview.classList.remove('hidden');
      messageInput.focus();
    }

    function cancelReply() {
      replyToMessage = null;
      replyPreview.classList.add('hidden');
    }

    cancelReplyBtn.addEventListener('click', cancelReply);

    function openEditModal(data) {
      editingMessageId = data.id;
      editMessageInput.value = data.message;
      editModal.classList.remove('hidden');
      editMessageInput.focus();
    }

    document.getElementById('save-edit-btn').addEventListener('click', () => {
      const newMessage = editMessageInput.value.trim();
      if (newMessage && editingMessageId) {
        socket.emit('editMessage', { id: editingMessageId, newMessage }, (response) => {
          if (response.success) {
            editModal.classList.add('hidden');
            editingMessageId = null;
          } else {
            alert(response.error);
          }
        });
      }
    });

    document.getElementById('cancel-edit-btn').addEventListener('click', () => {
      editModal.classList.add('hidden');
      editingMessageId = null;
    });

    function addSystemMessage(text) {
      const div = document.createElement('div');
      div.className = 'system-message';
      div.textContent = text;
      chatBox.appendChild(div);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    function updateUserList(users) {
      userCount.textContent = `${users.length}‰∫∫`;
      userNames.textContent = users.join(', ');
    }

    document.getElementById('updateProfileButton').addEventListener('click', () => {
      const data = {
        color: document.getElementById('nameColor').value,
        statusText: document.getElementById('statusText').value.trim(),
        theme: themeSelect.value
      };

      socket.emit('updateAccountProfile', data, (response) => {
        if (response.success) {
          currentProfile = { ...currentProfile, ...response.account };
          applyTheme(response.account.theme);
          userStatusMap[currentUser] = response.account.statusText;
          alert('„Éó„É≠„Éï„Ç£„Éº„É´„ÇíÊõ¥Êñ∞„Åó„Åæ„Åó„Åü');
        } else {
          alert(response.error || 'Êõ¥Êñ∞„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
        }
      });
    });

    themeSelect.addEventListener('change', () => {
      applyTheme(themeSelect.value);
    });

    document.getElementById('logoutButton').addEventListener('click', () => {
      const token = localStorage.getItem('chatToken');
      socket.emit('accountLogout', { token });
      stopHeartbeat();
      localStorage.removeItem('chatToken');
      localStorage.removeItem('chatDisplayName');
      window.location.reload();
    });

    socket.on('message', (data) => {
      addMessage(data);
    });

    socket.on('messageEdited', (data) => {
      const container = document.querySelector(`.message-container[data-id="${data.id}"]`);
      if (container) {
        const textEl = container.querySelector('.message-text');
        const metaEl = container.querySelector('.message-meta');
        textEl.innerHTML = escapeHtml(data.message).replace(/\n/g, '<br>');
        if (!metaEl.querySelector('.edited-mark')) {
          metaEl.innerHTML += '<span class="edited-mark">(Á∑®ÈõÜÊ∏à„Åø)</span>';
        }
      }
    });

    socket.on('messageDeleted', ({ id }) => {
      const container = document.querySelector(`.message-container[data-id="${id}"]`);
      if (container) {
        container.remove();
      }
    });

    socket.on('allMessagesDeleted', () => {
      chatBox.innerHTML = '';
      addSystemMessage('ÁÆ°ÁêÜËÄÖ„Åå„Åô„Åπ„Å¶„ÅÆ„É°„ÉÉ„Çª„Éº„Ç∏„ÇíÂâäÈô§„Åó„Åæ„Åó„Åü');
    });

    socket.on('systemMessage', (text) => {
      addSystemMessage(text);
    });

    socket.on('userJoined', (data) => {
      addSystemMessage(`${data.username} „Åå„ÉÅ„É£„ÉÉ„Éà„Å´ÂèÇÂä†„Åó„Åæ„Åó„Åü`);
      updateUserList(data.users);
    });

    socket.on('userLeft', (data) => {
      addSystemMessage(`${data.username} „Åå„ÉÅ„É£„ÉÉ„Éà„Åã„ÇâÈÄÄÂá∫„Åó„Åæ„Åó„Åü`);
      updateUserList(data.users);
    });

    socket.on('userListUpdate', (users) => {
      updateUserList(users);
    });

    socket.on('userStatusUpdate', (data) => {
      userStatusMap[data.username] = data.statusText;
    });

    socket.on('privateMessage', (data) => {
      const pmDiv = document.createElement('div');
      pmDiv.className = 'message-container';
      pmDiv.style.backgroundColor = '#ffe6f0';
      pmDiv.style.borderLeft = '4px solid #e91e63';
      pmDiv.innerHTML = `
        <div class="message-name" style="color: ${data.color || '#e91e63'}">üîí ${escapeHtml(data.from)} „Åã„Çâ„ÅÆ„Éó„É©„Ç§„Éô„Éº„Éà„É°„ÉÉ„Çª„Éº„Ç∏</div>
        <div class="message-text">${escapeHtml(data.message)}</div>
        <div class="message-meta">
          <span class="message-time">${formatTime(data.timestamp)}</span>
        </div>
      `;
      chatBox.appendChild(pmDiv);
      chatBox.scrollTop = chatBox.scrollHeight;
    });

    socket.on('privateMessageSent', (data) => {
      addSystemMessage(`üîí ${data.to} „Å´„Éó„É©„Ç§„Éô„Éº„Éà„É°„ÉÉ„Çª„Éº„Ç∏„ÇíÈÄÅ‰ø°„Åó„Åæ„Åó„Åü`);
    });

    socket.on('banned', (data) => {
      alert(data.message);
      stopHeartbeat();
      currentUser = null;
      currentProfile = null;
      localStorage.removeItem('chatToken');
      localStorage.removeItem('chatDisplayName');
      chatSection.classList.add('hidden');
      authSection.classList.remove('hidden');
      chatBox.innerHTML = '';
      document.body.className = 'theme-default';
    });

    socket.on('userTyping', (username) => {
      typingIndicator.textContent = `${username} „ÅåÂÖ•Âäõ‰∏≠...`;
      typingIndicator.classList.remove('hidden');
    });

    socket.on('userStopTyping', () => {
      typingIndicator.classList.add('hidden');
    });

    socket.on('profileUpdated', (data) => {
      if (data.color) {
        currentProfile.color = data.color;
        document.getElementById('nameColor').value = data.color;
      }
    });

    socket.on('server-ping', () => {
      socket.emit('heartbeat');
    });

    socket.on('heartbeat-ack', () => {});

    socket.on('connect', () => {
      console.log('Connected to server');
      const token = localStorage.getItem('chatToken');
      if (currentUser && token) {
        socket.emit('tokenLogin', { token }, (response) => {
          if (response && response.success) {
            addSystemMessage('„Çµ„Éº„Éê„Éº„Å´ÂÜçÊé•Á∂ö„Åó„Åæ„Åó„Åü');
            isAdmin = response.account.isAdmin;
            if (isAdmin) {
              document.getElementById('admin-indicator').classList.remove('hidden');
            }
            chatBox.innerHTML = '';
            if (response.history && response.history.length > 0) {
              response.history.forEach(msg => addMessage(msg));
            }
            if (response.userStatuses) {
              userStatusMap = response.userStatuses;
            }
            updateUserList(response.onlineUsers || []);
            startHeartbeat();
          } else {
            localStorage.removeItem('chatToken');
            localStorage.removeItem('chatDisplayName');
            window.location.reload();
          }
        });
      }
    });

    socket.on('disconnect', (reason) => {
      console.log('Disconnected from server:', reason);
      stopHeartbeat();
      if (currentUser) {
        addSystemMessage('„Çµ„Éº„Éê„Éº„Å®„ÅÆÊé•Á∂ö„ÅåÂàáÊñ≠„Åï„Çå„Åæ„Åó„Åü„ÄÇÂÜçÊé•Á∂ö‰∏≠...');
      }
    });

    socket.on('reconnect', (attemptNumber) => {
      console.log(`Reconnected after ${attemptNumber} attempts`);
    });

    socket.on('reconnect_failed', () => {
      addSystemMessage('ÂÜçÊé•Á∂ö„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ„Éö„Éº„Ç∏„Çí„É™„É≠„Éº„Éâ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
    });

    socket.on('connect_error', (error) => {
      console.log('Connection error:', error.message);
    });
  </script>
</body>
</html>
